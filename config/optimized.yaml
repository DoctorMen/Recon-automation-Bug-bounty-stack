# OPTIMIZED CONFIGURATION FOR 24GB RAM SYSTEM
# This configuration maximizes speed and attack efficiency
# System: x64, 24GB RAM, ~100 Mbps network
# Performance: 3-4x faster than standard configuration

# Global Settings
global:
  max_memory_mb: 20000          # Use up to 20GB RAM (83% of 24GB)
  max_cpu_percent: 90           # Use up to 90% CPU
  max_network_mbps: 95          # Use up to 95 Mbps
  temp_directory: ./temp
  log_level: INFO
  async_enabled: true
  compression_enabled: true

# Reconnaissance Phase
reconnaissance:
  subfinder:
    threads: 50                 # 50 concurrent DNS queries
    timeout: 1800               # 30 minutes
    resolvers: 25               # 25 DNS resolvers
    sources: all
    recursive: true
    all: true
  
  amass:
    max_dns_queries: 10000      # 10K queries (uses ~2GB RAM)
    timeout: 1800
    mode: passive
    max_resolvers: 25
  
  dnsx:
    threads: 100                # 100 concurrent validations
    timeout: 10
    retries: 2
    record_types: [A, AAAA, CNAME, MX, NS, TXT, SOA]

# HTTP Probing Phase
http_probing:
  httpx:
    threads: 100                # 100 concurrent connections
    rate_limit: 150             # 150 requests/second
    timeout: 10
    retries: 2
    max_redirects: 10
    follow_redirects: true
    methods: [GET, POST, OPTIONS]
    tech_detect: true
    status_code: true
    title: true
    content_length: true
    websocket: true
    pipeline: true
    http2: true

# Vulnerability Scanning Phase
vulnerability_scanning:
  nuclei:
    threads: 50                 # 50 concurrent template executions
    concurrency: 50
    rate_limit: 150             # 150 requests/second
    bulk_size: 25               # Process 25 templates in parallel
    timeout: 10
    retries: 2
    severity: [critical, high, medium]
    max_host_error: 30          # Skip host after 30 errors
    interactsh: true            # Enable out-of-band testing
    automatic_scan: true
    passive: true
    follow_redirects: true
    exclude_tags: [dos, fuzzing, malware]
    markdown_export: true

# API Testing Phase
api_testing:
  concurrent_endpoints: 30      # Test 30 API endpoints simultaneously
  requests_per_endpoint: 20     # 20 test cases per endpoint
  rate_limit: 100               # 100 API requests/second
  timeout: 15                   # 15 seconds for API responses
  payload_threads: 10           # 10 concurrent payload variations
  fuzzing_depth: 3              # 3 levels of parameter fuzzing
  graphql_max_depth: 5          # GraphQL nesting level
  
  test_categories:
    authentication: true
    authorization: true
    idor: true
    mass_assignment: true
    rate_limiting: true
    jwt_manipulation: true
    oauth_flaws: true
    graphql_introspection: true
    parameter_pollution: true
    batch_operations: true

# Cryptographic Analysis Phase
crypto_analysis:
  concurrent_scans: 20          # 20 concurrent crypto analysis tasks
  jwt_variations: 50            # Test 50 JWT variations
  token_entropy_samples: 100    # Analyze 100 tokens for predictability
  timing_attack_samples: 1000   # 1000 samples for timing analysis
  hash_crack_threads: 8         # 8 threads for hash cracking
  verify_exploitability: true   # Actually test vulnerabilities
  
  detection_types:
    weak_encryption: true
    weak_hashes: true
    timing_attacks: true
    predictable_tokens: true
    jwt_weaknesses: true
    oauth_flaws: true
    weak_randomness: true

# Exploitation Phase
exploitation:
  concurrent_exploits: 15       # 15 concurrent exploit attempts
  payload_variations: 100       # Generate 100 payload variations
  race_condition_threads: 50    # 50 threads for race conditions
  brute_force_threads: 20       # 20 threads for brute forcing
  sqli_payloads: 500            # 500 SQLi payload variations
  xss_payloads: 300             # 300 XSS payload variations
  smart_targeting: true         # Focus on high-value targets
  avoid_noise: true             # Minimize detection
  
  attack_priorities:
    rce: 10                     # Remote Code Execution (highest)
    auth_bypass: 9              # Authentication Bypass
    idor: 8                     # IDOR / Privilege Escalation
    sqli: 8                     # SQL Injection
    business_logic: 7           # Business Logic Flaws
    api_vulnerabilities: 8      # API Security Issues
    crypto_weaknesses: 6        # Cryptographic Vulnerabilities

# Network Optimization
network:
  max_concurrent_connections: 200    # 200 simultaneous connections
  connection_pool_size: 50           # Pool of 50 persistent connections
  keep_alive: true                   # HTTP keep-alive enabled
  tcp_fast_open: true                # Enable TCP Fast Open
  http2_enabled: true                # HTTP/2 support
  compression: true                  # Enable gzip/brotli
  dns_cache_size: 10000              # Cache 10,000 DNS entries
  dns_cache_ttl: 3600                # 1 hour DNS cache TTL
  socket_timeout: 30                 # 30 second socket timeout
  max_retries: 3                     # Retry failed requests 3 times
  backoff_factor: 0.3                # Exponential backoff
  session_reuse: true                # Reuse TCP sessions

# Disk I/O Optimization
disk_io:
  async_writes: true                 # Asynchronous log writing
  buffer_size_mb: 100                # 100MB write buffer
  compression_enabled: true          # Compress logs on-the-fly
  batch_write_interval: 5            # Write every 5 seconds
  max_log_size_gb: 10                # Max 10GB per log file
  log_rotation_enabled: true         # Auto-rotate logs
  result_cache_mb: 500               # 500MB result cache

# Output Configuration
output:
  formats: [json, markdown, html]
  compression: true
  async_writes: true
  buffer_size_mb: 100
  include_raw_requests: false        # Exclude to save space
  include_raw_responses: false       # Exclude to save space
  screenshot_enabled: false          # Disable for speed
  
  findings_filter:
    min_severity: medium
    exclude_info: true               # Exclude informational findings
    exclude_duplicates: true
    verified_only: false             # Include unverified findings

# Monitoring & Auto-Tuning
monitoring:
  enabled: true
  interval_seconds: 10               # Check every 10 seconds
  
  thresholds:
    memory_warning_mb: 20000         # 20GB (83%)
    memory_critical_mb: 22000        # 22GB (92%)
    cpu_warning_percent: 85
    cpu_critical_percent: 95
    network_warning_mbps: 80
    network_critical_mbps: 95
  
  auto_tune:
    enabled: true
    reduce_on_warning: 20            # Reduce by 20% on warning
    reduce_on_critical: 40           # Reduce by 40% on critical
    increase_on_idle: 10             # Increase by 10% when idle
    
# Concurrent Target Handling
multi_target:
  enabled: true
  max_concurrent_small: 10           # 10 small targets (<100 subs)
  max_concurrent_medium: 5           # 5 medium targets (100-1000 subs)
  max_concurrent_large: 2            # 2 large targets (1000+ subs)
  ram_per_small_mb: 500
  ram_per_medium_mb: 2000
  ram_per_large_mb: 8000

# Attack Mode Presets
attack_modes:
  aggressive:
    description: "Maximum speed, high detection risk"
    requests_per_second: 200
    concurrent_connections: 200
    delays: none
    user_agents: 1
  
  balanced:
    description: "Good speed, moderate stealth (RECOMMENDED)"
    requests_per_second: 100
    concurrent_connections: 100
    delays: random_0.01-0.1s
    user_agents: 5
  
  stealth:
    description: "Slow speed, maximum stealth"
    requests_per_second: 20
    concurrent_connections: 20
    delays: random_0.5-2s
    user_agents: 20
  
  smart_adaptive:
    description: "Adapts to target response (RECOMMENDED)"
    initial_rate: 50
    max_rate: 150
    min_rate: 10
    adaptation: true

# Default Attack Mode (change this)
default_attack_mode: balanced

# Reporting
reporting:
  auto_generate: true
  formats: [markdown, html, json]
  include_executive_summary: true
  include_compliance_mapping: true
  include_risk_matrix: true
  include_proof_of_concept: true
  include_remediation_roadmap: true
  certificate_cover: true
  
  compliance_frameworks:
    - OWASP Top 10
    - PCI DSS
    - GDPR
    - ISO 27001

# Performance Targets
performance_targets:
  subdomains_per_minute: 200
  http_probes_per_minute: 600
  vulnerability_scans_per_minute: 300
  api_tests_per_minute: 180
  total_pipeline_minutes: 30           # Complete pipeline in 30 min

# System Information (Auto-detected)
system_info:
  ram_gb: 24
  cpu_arch: x64
  os: Windows 10 + WSL Ubuntu
  optimization_level: high_performance
  performance_tier: "TOP 0.5%"

