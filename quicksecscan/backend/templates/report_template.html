<!--
Copyright © 2025 DoctorMen. All Rights Reserved.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QuickSecScan Report — {{ domain }}</title>
    <style>
        @page { size: A4; margin: 20mm; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; color: #1e293b; line-height: 1.6; }
        h1 { font-size: 28px; color: #0ea5e9; margin-bottom: 4px; }
        h2 { font-size: 20px; color: #334155; margin-top: 24px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px; }
        h3 { font-size: 16px; color: #475569; margin-top: 16px; }
        .header { background: linear-gradient(135deg, #0ea5e9, #84cc16); padding: 24px; color: white; border-radius: 8px; margin-bottom: 24px; }
        .header h1 { color: white; margin: 0; }
        .meta { font-size: 14px; color: #f1f5f9; margin-top: 8px; }
        .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin: 24px 0; }
        .metric { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; text-align: center; }
        .metric .value { font-size: 32px; font-weight: 800; margin: 8px 0; }
        .metric .label { font-size: 12px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; }
        .critical { color: #dc2626; }
        .high { color: #ea580c; }
        .medium { color: #f59e0b; }
        .finding { background: #fafafa; border-left: 4px solid #cbd5e1; padding: 16px; margin: 12px 0; border-radius: 4px; page-break-inside: avoid; }
        .finding.critical { border-left-color: #dc2626; background: #fef2f2; }
        .finding.high { border-left-color: #ea580c; background: #fff7ed; }
        .finding.medium { border-left-color: #f59e0b; background: #fffbeb; }
        .finding-title { font-weight: 700; font-size: 16px; margin-bottom: 8px; }
        .finding-meta { font-size: 13px; color: #64748b; margin-bottom: 8px; }
        .finding-desc { font-size: 14px; margin: 8px 0; }
        .footer { margin-top: 48px; padding-top: 16px; border-top: 1px solid #e2e8f0; font-size: 12px; color: #64748b; text-align: center; }
    </style>
</head>
<body>
    <div class="header">
        <h1>QuickSecScan Report</h1>
        <div class="meta">
            <strong>Domain:</strong> {{ domain }}<br>
            <strong>Scan Date:</strong> {{ scan_date }}<br>
            <strong>Tier:</strong> Basic (Automated)
        </div>
    </div>

    <h2>Executive Summary</h2>
    <div class="summary">
        <div class="metric">
            <div class="value">{{ total_findings }}</div>
            <div class="label">Total Findings</div>
        </div>
        <div class="metric">
            <div class="value critical">{{ severity_counts.CRITICAL }}</div>
            <div class="label">Critical</div>
        </div>
        <div class="metric">
            <div class="value high">{{ severity_counts.HIGH }}</div>
            <div class="label">High</div>
        </div>
        <div class="metric">
            <div class="value medium">{{ severity_counts.MEDIUM }}</div>
            <div class="label">Medium</div>
        </div>
    </div>

    {% if total_findings == 0 %}
    <div style="background:#f0fdf4;border:1px solid #86efac;padding:24px;border-radius:8px;margin:24px 0;">
        <h3 style="color:#16a34a;margin-top:0;">✓ No Critical Issues Found</h3>
        <p>Our automated scan did not detect any critical, high, or medium severity vulnerabilities on <strong>{{ domain }}</strong>.</p>
        <p><strong>Note:</strong> This is an automated scan. For comprehensive manual testing, consider upgrading to our Pro or Team tier.</p>
    </div>
    {% else %}
    <h2>Detailed Findings</h2>
    <p>The following issues were detected during the automated scan. Findings are sorted by severity (Critical → High → Medium).</p>

    {% for finding in findings | sort(attribute='severity', reverse=true) %}
    <div class="finding {{ finding.severity | lower }}">
        <div class="finding-title">
            <span style="display:inline-block;background:{% if finding.severity == 'CRITICAL' %}#dc2626{% elif finding.severity == 'HIGH' %}#ea580c{% else %}#f59e0b{% endif %};color:white;padding:2px 8px;border-radius:4px;font-size:11px;margin-right:8px;">{{ finding.severity }}</span>
            {{ finding.name }}
        </div>
        <div class="finding-meta">
            <strong>Host:</strong> {{ finding.host }}<br>
            {% if finding.matched_at %}<strong>Matched at:</strong> {{ finding.matched_at }}<br>{% endif %}
            {% if finding.cwe %}<strong>CWE:</strong> {{ finding.cwe | join(', ') }}<br>{% endif %}
            {% if finding.cvss > 0 %}<strong>CVSS Score:</strong> {{ finding.cvss }}<br>{% endif %}
        </div>
        {% if finding.description %}
        <div class="finding-desc">{{ finding.description }}</div>
        {% endif %}
    </div>
    {% endfor %}
    {% endif %}

    <h2>Methodology</h2>
    <p>This report was generated using automated tools:</p>
    <ul>
        <li><strong>Subfinder:</strong> Subdomain enumeration</li>
        <li><strong>HTTPx:</strong> HTTP probing and technology detection</li>
        <li><strong>Nuclei:</strong> Vulnerability scanning with OWASP-aligned templates</li>
    </ul>
    <p><strong>Scope:</strong> All publicly accessible assets under <code>{{ domain }}</code>.</p>
    <p><strong>Limitations:</strong> This is a non-intrusive, automated scan. It does not include manual testing, authentication bypass attempts, or logic flaw discovery.</p>

    <h2>Recommendations</h2>
    {% if total_findings > 0 %}
    <ol>
        <li>Review and prioritize findings by severity (Critical/High first)</li>
        <li>Apply vendor patches or configuration changes to remediate issues</li>
        <li>Re-scan after fixes to verify remediation</li>
        <li>For comprehensive testing, consider upgrading to our Pro or Team tier for manual review</li>
    </ol>
    {% else %}
    <ul>
        <li>Continue regular security scans (weekly or after major releases)</li>
        <li>Consider manual penetration testing for business-critical applications</li>
        <li>Implement a bug bounty program or security code review process</li>
    </ul>
    {% endif %}

    <div class="footer">
        <p><strong>QuickSecScan — Automated Security Scans for Startups</strong><br>
        Report generated {{ scan_date }} | Valid for 30 days<br>
        Questions? Contact us at <a href="mailto:support@quicksecscan.com">support@quicksecscan.com</a></p>
        <p style="font-size:10px;color:#94a3b8;margin-top:12px;">This report is confidential and intended solely for the recipient. Redistribution without permission is prohibited.</p>
    </div>
</body>
</html>

