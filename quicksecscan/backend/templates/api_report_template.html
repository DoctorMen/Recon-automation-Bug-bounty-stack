<!--
Copyright © 2025 DoctorMen. All Rights Reserved.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QuickSecScan API Security Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; color: #333; }
        .header { text-align: center; border-bottom: 3px solid #0ea5e9; padding-bottom: 20px; margin-bottom: 30px; }
        .header h1 { color: #0ea5e9; margin: 0; }
        .summary { background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; text-align: center; }
        .severity-critical { background: #ef4444; color: white; padding: 10px; border-radius: 6px; }
        .severity-high { background: #f59e0b; color: white; padding: 10px; border-radius: 6px; }
        .severity-medium { background: #eab308; color: white; padding: 10px; border-radius: 6px; }
        .finding { margin-bottom: 30px; padding: 20px; border-left: 4px solid #0ea5e9; background: #f8fafc; }
        .finding h3 { margin-top: 0; color: #0ea5e9; }
        .severity-badge { display: inline-block; padding: 4px 12px; border-radius: 4px; font-weight: bold; margin-bottom: 10px; }
        .badge-critical { background: #ef4444; color: white; }
        .badge-high { background: #f59e0b; color: white; }
        .badge-medium { background: #eab308; color: white; }
        .poc { background: #1e293b; color: #84cc16; padding: 15px; border-radius: 6px; font-family: monospace; margin: 10px 0; }
        .recommendation { background: #dbeafe; padding: 15px; border-radius: 6px; margin-top: 10px; }
        .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #e2e8f0; text-align: center; color: #64748b; }
    </style>
</head>
<body>
    <div class="header">
        <h1>QuickSecScan API Security Report</h1>
        <p><strong>Target:</strong> {{ target }}</p>
        <p><strong>Scan Date:</strong> {{ scan_date }}</p>
        <p><strong>Scan Type:</strong> {{ scan_type }}</p>
    </div>

    <div class="summary">
        <h2>Executive Summary</h2>
        <div class="summary-grid">
            <div class="severity-critical">
                <div style="font-size: 32px; font-weight: bold;">{{ severity_counts.CRITICAL }}</div>
                <div>Critical</div>
            </div>
            <div class="severity-high">
                <div style="font-size: 32px; font-weight: bold;">{{ severity_counts.HIGH }}</div>
                <div>High</div>
            </div>
            <div class="severity-medium">
                <div style="font-size: 32px; font-weight: bold;">{{ severity_counts.MEDIUM }}</div>
                <div>Medium</div>
            </div>
            <div style="background: #0ea5e9; color: white; padding: 10px; border-radius: 6px;">
                <div style="font-size: 32px; font-weight: bold;">{{ total_findings }}</div>
                <div>Total Findings</div>
            </div>
        </div>
    </div>

    <div class="findings">
        <h2>Detailed Findings</h2>
        {% for finding in findings %}
        <div class="finding">
            <span class="severity-badge badge-{{ finding.severity.lower() }}">{{ finding.severity }}</span>
            <h3>{{ finding.name }}</h3>
            <p><strong>Endpoint:</strong> {{ finding.host }}</p>
            <p><strong>Description:</strong> {{ finding.description }}</p>
            {% if finding.poc %}
            <div class="poc">
                <strong>Proof of Concept:</strong><br>
                {{ finding.poc }}
            </div>
            {% endif %}
            {% if finding.recommendation %}
            <div class="recommendation">
                <strong>Recommendation:</strong> {{ finding.recommendation }}
            </div>
            {% endif %}
            {% if finding.matched_at %}
            <p><strong>Matched At:</strong> {{ finding.matched_at }}</p>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <div class="footer">
        <p>Generated by QuickSecScan — Automated API Security Testing</p>
        <p>For questions or support, contact: support@quicksecscan.com</p>
        <p>Report valid for 30 days from generation date.</p>
    </div>
</body>
</html>

