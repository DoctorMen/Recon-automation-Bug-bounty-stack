{
  "target": "Kuru DEX",
  "contracts_analyzed": [
    "Vault",
    "KuruAMMVault",
    "MarginAccount",
    "Router",
    "OrderBook"
  ],
  "findings": [
    {
      "severity": "NEEDS_REVIEW",
      "title": "Verify Access Control: creditFee()",
      "description": "creditFee can manipulate user balances",
      "check": "Verify onlyMarket or similar modifier in source"
    },
    {
      "severity": "NEEDS_REVIEW",
      "title": "Verify Access Control: creditUser()",
      "description": "creditUser can manipulate user balances",
      "check": "Verify onlyMarket or similar modifier in source"
    },
    {
      "severity": "NEEDS_REVIEW",
      "title": "Verify Access Control: creditUsersEncoded()",
      "description": "creditUsersEncoded can manipulate user balances",
      "check": "Verify onlyMarket or similar modifier in source"
    },
    {
      "severity": "NEEDS_REVIEW",
      "title": "Verify Access Control: debitUser()",
      "description": "debitUser can manipulate user balances",
      "check": "Verify onlyMarket or similar modifier in source"
    },
    {
      "severity": "MEDIUM",
      "title": "Encoded Data Parsing Risk",
      "description": "creditUsersEncoded takes raw bytes - check for overflow/underflow in parsing",
      "attack": "Malformed encoded data could credit wrong amounts"
    },
    {
      "severity": "MEDIUM",
      "title": "Flip Order Price Validation",
      "description": "Check: Can _flippedPrice be set outside market bounds?",
      "check": "Verify _flippedPrice <= _price for buys, >= _price for sells"
    },
    {
      "severity": "MEDIUM",
      "title": "Flip Order Price Validation",
      "description": "Check: Can _flippedPrice be set outside market bounds?",
      "check": "Verify _flippedPrice <= _price for buys, >= _price for sells"
    },
    {
      "severity": "LOW",
      "title": "Array Length Validation: batchAddPairedLiquidity",
      "description": "Function has 4 array inputs",
      "check": "Verify all arrays must have same length"
    },
    {
      "severity": "LOW",
      "title": "Array Length Validation: batchProvisionLiquidity",
      "description": "Function has 4 array inputs",
      "check": "Verify all arrays must have same length"
    },
    {
      "severity": "LOW",
      "title": "Array Length Validation: placeMultipleBuyOrders",
      "description": "Function has 2 array inputs",
      "check": "Verify all arrays must have same length"
    },
    {
      "severity": "LOW",
      "title": "Array Length Validation: placeMultipleSellOrders",
      "description": "Function has 2 array inputs",
      "check": "Verify all arrays must have same length"
    },
    {
      "severity": "HIGH",
      "title": "Multi-hop Swap Reentrancy Risk",
      "description": "anyToAnySwap iterates through multiple markets",
      "check": "Verify CEI pattern, nonReentrant modifier",
      "attack_vectors": [
        "Reentrancy between market hops",
        "Array length mismatch (marketAddresses vs isBuy vs nativeSend)",
        "Native/ERC20 accounting confusion",
        "Slippage check timing (_minAmountOut at end?)"
      ]
    }
  ],
  "summary": {
    "NEEDS_REVIEW": 4,
    "MEDIUM": 3,
    "LOW": 4,
    "HIGH": 1
  }
}