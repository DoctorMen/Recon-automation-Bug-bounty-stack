{
  "total_verified": 32,
  "reentrancy": 0,
  "flash_loan_attack": 2,
  "liquidity_pool_exploit": 30,
  "findings": [
    {
      "type": "flash_loan_attack",
      "contract": "contracts/RouterHelper.sol",
      "line": 57,
      "function": "function getAmountsOut(uint amountIn, IRouter.route[] memory routes) public returns (uint[] memory amounts, uint[] memory priceBeforeSwap, uint[] memory priceAfterSwap) {",
      "severity": "critical",
      "description": "Potential flash loan attack vulnerability: Price calculation without oracle validation or minimum liquidity check",
      "recommendation": "Add oracle price validation or minimum liquidity requirements to prevent price manipulation"
    },
    {
      "type": "flash_loan_attack",
      "contract": "contracts/RouterHelper.sol",
      "line": 124,
      "function": "function _swapRatio(uint amountIn, address tokenIn, address pair, uint amountOut) internal view returns (bool, uint, uint){",
      "severity": "critical",
      "description": "Potential flash loan attack vulnerability: Price calculation without oracle validation or minimum liquidity check",
      "recommendation": "Add oracle price validation or minimum liquidity requirements to prevent price manipulation"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 217,
      "code": "uint _supplied = balanceOf[recipient]; // get LP balance of `recipient`",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 371,
      "code": "amount0 = _liquidity * _balance0 / _totalSupply; // using balances ensures pro-rata distribution",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 372,
      "code": "amount1 = _liquidity * _balance1 / _totalSupply; // using balances ensures pro-rata distribution",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 424,
      "code": "_safeTransfer(_token0, to, IERC20(_token0).balanceOf(address(this)) - (reserve0));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 425,
      "code": "_safeTransfer(_token1, to, IERC20(_token1).balanceOf(address(this)) - (reserve1));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 430,
      "code": "_update(IERC20(token0).balanceOf(address(this)), IERC20(token1).balanceOf(address(this)), reserve0, reserve1);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 501,
      "code": "balanceOf[dst] += amount;",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 508,
      "code": "balanceOf[dst] -= amount;",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 568,
      "code": "balanceOf[src] -= amount;",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/Pair.sol",
      "line": 569,
      "code": "balanceOf[dst] += amount;",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 173,
      "code": "function balanceOf(address account) external view returns (uint256) {",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 174,
      "code": "return _balanceOf(account);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 177,
      "code": "function _balanceOf(address account) internal view returns (uint256) {",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 179,
      "code": "if(genesisPool != address(0)) balance += IGenesisPool(genesisPool).balanceOf(account);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 199,
      "code": "return rewards[account] + _balanceOf(account) * (rewardPerToken() - userRewardPerTokenPaid[account]) / 1e18;",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 238,
      "code": "_deposit(TOKEN.balanceOf(msg.sender), msg.sender);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 263,
      "code": "_withdraw(_balanceOf(msg.sender));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 315,
      "code": "if(genesisPool != address(0)) gensisBalance = IGenesisPool(genesisPool).balanceOf(msg.sender);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 328,
      "code": "_withdraw(_balanceOf(msg.sender));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 343,
      "code": "IRewarder(gaugeRewarder).onReward(_user, _user, _balanceOf(_user));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 357,
      "code": "IRewarder(gaugeRewarder).onReward(msg.sender, msg.sender, _balanceOf(msg.sender));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/GaugeV2.sol",
      "line": 398,
      "code": "uint256 balance = rewardToken.balanceOf(address(this));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 190,
      "code": "token0 = IERC20(_token0).balanceOf(address(this));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 191,
      "code": "token1 = IERC20(_token1).balanceOf(address(this));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 199,
      "code": "//     token0 = IERC20(_token0).balanceOf(communityVault);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 200,
      "code": "//     token1 = IERC20(_token1).balanceOf(communityVault);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 220,
      "code": "claimed0 = IERC20(_token0).balanceOf(address(this));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 221,
      "code": "claimed1 = IERC20(_token1).balanceOf(address(this));",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 297,
      "code": "communityVaultAccruedFeeToken0 = IERC20(algebraPool.token0()).balanceOf(communityVault);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    },
    {
      "type": "liquidity_pool_exploit",
      "contract": "contracts/AlgebraCLVe33/GaugeCL.sol",
      "line": 298,
      "code": "communityVaultAccruedFeeToken1 = IERC20(algebraPool.token1()).balanceOf(communityVault);",
      "severity": "critical",
      "description": "Potential liquidity pool exploit: Balance manipulation without validation",
      "recommendation": "Add validation checks before balance modifications"
    }
  ]
}